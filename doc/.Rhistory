plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=0.3,y=1,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote
Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2))
}
plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=0.3,y=1,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2))
}
plot.geno.vs.HW("../results_answerkey/HWE/H938.hwe_reduced", title = "HGDP")
plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=1,y=1,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2))
}
plot.geno.vs.HW("../results_answerkey/HWE/H938.hwe_reduced", title = "HGDP")
plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=1,y=1,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2), cex=0.5, pt.cex = 1)
}
plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=0.5,y=0.25,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2), cex=0.5, pt.cex = 1)
}
plot.geno.vs.HW("../results_answerkey/HWE/H938.hwe_reduced", title = "HGDP")
plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=0.5,y=1,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2), cex=0.5, pt.cex = 1)
}
plot.geno.vs.HW("../results_answerkey/HWE/H938.hwe_reduced", title = "HGDP")
plot.geno.vs.HW<-function(file,title=""){
#read in the HW file from plink
plink.hwe<-read.table(file,as.is=TRUE)
names(plink.hwe)<-c("chr","SNP.id","which.inds","a1","a2",
"genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(plink.hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
geno.freq<-counts/tot.counts
allele.freq<-(geno.freq[,1]+.5*geno.freq[,2])
these.minor<-sample(1:nrow(geno.freq),3000)
these.major<-sample(1:nrow(geno.freq),3000)
ss.allele<-c(allele.freq[these.minor],1-allele.freq[these.major])
ss.geno<-rbind(geno.freq[these.minor,],geno.freq[these.major,c(3,2,1)])
# If you have adjustcolor library installed the following code is nice...
#plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("red",0.1), xlab="allele frequency",ylab="genotype #frequency",main=title)
#points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("blue",0.1))
#points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col=adjustcolor("green",0.1))
plot(ss.allele,ss.geno[,1],xlim=c(0,1),ylim=c(0,1),col="red", xlab="allele frequency",ylab="genotype frequency",main=title)
points(ss.allele,ss.geno[,3],xlim=c(0,1),ylim=c(0,1),col="blue")
points(ss.allele,ss.geno[,2],xlim=c(0,1),ylim=c(0,1),col="green")
smooth=1/5
lines(lowess(ss.geno[,1]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,3]~ss.allele,f = smooth),col="black")
lines(lowess(ss.geno[,2]~ss.allele,f = smooth),col="black")
x=1:1000/1000
lines(x,x^2,lty=2)
lines(x,2*x*(1-x),lty=2)
lines(x,(1-x)^2,lty=2)
legend(x=0.3,y=1,col=c("red","blue","green",rep("black",2)),
legend=c("Homozygote AA","Homozygote aa","Heterozygote Aa","Mean","Hardy Weinberg Expectation"),
pch=c(rep(1,3),rep(NA,2)),lty=c(rep(NA,3),1,2), cex=0.75, pt.cex = 1)
}
plot.geno.vs.HW("../results_answerkey/HWE/H938.hwe_reduced", title = "HGDP")
file = "../results_answerkey/HWE/H938.hwe_reduced"
# Read in the HWE table and compute counts and allele frequencies
hwe<-read.table(file,as.is=TRUE)
names(hwe)<-c("chr","SNP.id","which.inds","a1","a2","genotype","obs.het","exp.het","HWE.pval")
counts<-sapply(hwe$genotype,function(x){as.numeric(strsplit(x,"/")[[1]])})
counts<-t(counts)
tot.counts<-rowSums(counts)
allele.counts<-(2*counts[,1]+counts[,2])
# Flip allele counts so that we are sure we always have the minor
# allele frequency
# (Note: this uses a trick based on boolean math where true/false = 1/0).
counts.maf = allele.counts*(allele.counts<=2*tot.counts-allele.counts) + (2*tot.counts-allele.counts)*(allele.counts>2*tot.counts-allele.counts)
# Set the number of individuals by looking at the sites w/ the most
# observed data
n=max(tot.counts)
# Make the plot but filter on using only sites with fully observed
# data (i.e. totcounts==n)
hist(counts.maf[tot.counts==n],xlab="Minor allele count", ylab="# of SNPs",main="Allele frequency spectra",breaks=n)
# Plot the expected minor allele frequency spectra for the standard
# neutral model (i.e. constant size population, all loci neutral)
# To do so we compute, Watterson's estimator of Theta
S=sum(tot.counts==n & counts.maf>0)
thetaW=S/sum(1/seq(1,2*n-1))
# Which determines the expected AFS
expectedAFS=(1/seq(1,n)+1/(n*2-seq(1,n))) * thetaW
# And then plot
lines(seq(1,n),expectedAFS,col=2)
# Note: This adds a red line displaying the expected AFS shape
# controlled to match the data w.r.t to Watterson's Theta (i.e. the total number of SNPs).
